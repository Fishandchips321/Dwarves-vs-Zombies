
(function($,window){'use strict';window.MediaPlaceholder={init:function(){if(this.loaded){return;}
this.loaded=true;this.imageLoaded=false;this.WikiaArticle=$('#WikiaArticle');if($.getUrlVar('diff')||$.getUrlVar('oldid')){return;}
this.setupVideoPlaceholders();this.setupImagePlaceholders();},setupImagePlaceholders:function(){var self=this;this.WikiaArticle.on('click','.wikiaImagePlaceholder a',function(e){var open,$this=$(this),props=self.getProps($this);e.preventDefault();open=function(){window.WMU_show(window.event,{gallery:-2,box:props.placeholderIndex,align:props.align,thumb:props.thumb,size:props.width,caption:props.caption,link:props.link,track:{action:Wikia.Tracker.ACTIONS.CLICK,category:'image-placeholder',label:'view-mode',method:'analytics'}});};$this.startThrobbing();if(!self.imageLoaded){$.when($.getResources([$.loadYUI,$.loadJQueryAIM,$.getSassCommonURL('extensions/wikia/WikiaMiniUpload/css/WMU.scss'),window.wgResourceBasePath+'/extensions/wikia/WikiaMiniUpload/js/WMU.js'])).done(function(){self.imageLoaded=true;$this.stopThrobbing();open();});}else{$this.stopThrobbing();open();}});},setupVideoPlaceholders:function(){var self=this;self.WikiaArticle.find('.wikiaVideoPlaceholder a').each(function(){var $this=$(this),props=self.getProps($this);$this.addVideoButton({embedPresets:props,insertFinalVideoParams:['placeholder=1','box='+props.placeholderIndex,'article='+encodeURIComponent(window.wgTitle),'ns='+window.wgNamespaceNumber],callbackAfterEmbed:$.proxy(self.videoEmbedCallback,self),track:{action:Wikia.Tracker.ACTIONS.CLICK,category:'video-placeholder',label:'view-mode',method:'analytics'}});});},videoEmbedCallback:function(embedData){var placeholders=this.WikiaArticle.find('.wikiaVideoPlaceholder a'),toUpdate=placeholders.filter('[data-id='+embedData.placeholderIndex+']'),html=$('#VideoEmbedCode').html();toUpdate.closest('.wikiaVideoPlaceholder').replaceWith(html);placeholders.each(function(){var $this=$(this),id=$this.attr('data-id');if(id>embedData.placeholderIndex){$this.attr('data-id',id-1);}});$.post(window.wgScript,{title:window.wgPageName,action:'purge'});this.setupVideoPlaceholders();},getProps:function($elem){return{placeholderIndex:$elem.attr('data-id'),align:$elem.attr('data-align'),width:$elem.attr('data-width'),thumb:$elem.attr('data-thumb'),link:$elem.attr('data-link'),caption:$elem.attr('data-caption')};}};})(jQuery,window);